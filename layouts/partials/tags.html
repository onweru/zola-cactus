<section id="writing">
  <span class="h1"><a href="{{ config.mainSection }}">{{ config.mainSectionTitle | default (value="Writings") }}</a></span>
  {{ if (and (and (config.tagsoverview) (eq config.tagsOverview true)) (gt (len .Site.Taxonomies.tags) 0)) }}
  <span class="h2">Topics</span>
  <span class="widget tagcloud">
    {{ $AllRegularPagesCount := len .Site.RegularPages }}
    {{ range $elem := .Site.Taxonomies.tags.Alphabetical }}
    <a style="font-size: {{ (add 0.5 (mul 5 (div (float $elem.Count) $AllRegularPagesCount))) }}rem;" href="{{ $elem.Page.Permalink }}">
      {{- .Page.Title -}}
    </a>
    {{ end }}
  </span>
  <span class="h2">Most recent</span>
  {{ end }}

  {{ $showAllPostsOnHomePage := false }}
  {{ if config.showallpostsonhomepage }}
    {{ $showAllPostsOnHomePage = config.ShowAllPostsOnHomePage }}
  {{ end }}
  {{ $dataFormat := config.dateFormat | default "2006-01-02" }}
  {{ $mainPosts := (sort ( where site.RegularPages "Type" "in" site.Params.mainSections ) "Date" "desc") }}
  {{ if $showAllPostsOnHomePage }}
  <ul class="post-list">
    {{ range (.Paginate $mainPosts).Pages }}
      <li class="post-item">
        <div class="meta"><time datetime="{{ time .Date }}" itemprop="datePublished">{{ .Date.Format $dataFormat }}</time></div>
        <span><a href="{{ .Permalink }}">{{ if .Title }} {{- .Title -}} {{ else }} {{- print "Untitled" -}}{{ end }}</a></span>
      </li>
    {{ end }}
  </ul>

  {{ partial "pagination.html" . }}

  {{ else }}
  <ul class="post-list">
    {{ .Scratch.Set "count" 5 }}
    {{ if config.postsonhomepage }}
      {{ .Scratch.Set "count" config.postsOnHomePage }}
    {{ end }}
    {{ range (first (.Scratch.Get "count") $mainPosts) }}
      <li class="post-item">
        <div class="meta"><time datetime="{{ time .Date }}" itemprop="datePublished">{{ .Date.Format $dataFormat }}</time></div>
        <span><a href="{{ .Permalink }}">{{ if .Title }} {{- .Title -}} {{ else }} {{- print "Untitled" -}}{{ end }}</a></span>
      </li>
    {{ end }}
  </ul>
  {{ end }}
</section>
